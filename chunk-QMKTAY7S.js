import{Wb as N,Zb as p,_ as D,db as I,ta as E,xb as B}from"./chunk-D6KF5352.js";var H=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],c=t=>{let e=0;for(let a=0;a<t.length;a++){let r=t[a],l=H.indexOf(r);e=e*83+l}return e};var b=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},v=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},R=t=>t<0?-1:1,x=(t,e)=>R(t)*Math.pow(Math.abs(t),e),O=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},$=t=>{if(!t||t.length<6)throw new O("The blurhash string must be at least 6 characters");let e=c(t[0]),a=Math.floor(e/9)+1,r=e%9+1;if(t.length!==4+2*r*a)throw new O(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*r*a}`)};var F=t=>{let e=t>>16,a=t>>8&255,r=t&255;return[b(e),b(a),b(r)]},L=(t,e)=>{let a=Math.floor(t/361),r=Math.floor(t/19)%19,l=t%19;return[x((a-9)/9,2)*e,x((r-9)/9,2)*e,x((l-9)/9,2)*e]},S=(t,e,a,r)=>{$(t),r=r|1;let l=c(t[0]),u=Math.floor(l/9)+1,n=l%9+1,m=(c(t[1])+1)/166,f=new Array(n*u);for(let h=0;h<f.length;h++)if(h===0){let o=c(t.substring(2,6));f[h]=F(o)}else{let o=c(t.substring(4+h*2,6+h*2));f[h]=L(o,m*r)}let s=e*4,i=new Uint8ClampedArray(s*a);for(let h=0;h<a;h++)for(let o=0;o<e;o++){let y=0,C=0,P=0;for(let M=0;M<u;M++)for(let d=0;d<n;d++){let g=Math.cos(Math.PI*o*d/e)*Math.cos(Math.PI*h*M/a),w=f[d+M*n];y+=w[0]*g,C+=w[1]*g,P+=w[2]*g}let j=v(y),q=v(C),A=v(P);i[4*o+0+h*s]=j,i[4*o+1+h*s]=q,i[4*o+2+h*s]=A,i[4*o+3+h*s]=255}return i},T=S;var V=class t{hash=p.required();width=p(32);height=p(32);el=D(E);constructor(){N(()=>{let e=this.el.nativeElement.querySelector("canvas");if(!e)return;let a=this.hash(),r=this.width(),l=this.height();try{let u=T(a,r,l);e.width=r,e.height=l;let n=e.getContext("2d");if(n){let m=n.createImageData(r,l);m.data.set(u),n.putImageData(m,0,0)}}catch{}})}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=I({type:t,selectors:[["app-blurhash-placeholder"]],inputs:{hash:[1,"hash"],width:[1,"width"],height:[1,"height"]},decls:2,vars:0,consts:[["canvas",""]],template:function(a,r){a&1&&B(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;position:absolute;inset:0}canvas[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}"]})};export{V as a};
