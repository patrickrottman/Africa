import{a as G,b as W}from"./chunk-PKMP4JHZ.js";import{a as $}from"./chunk-QMKTAY7S.js";import"./chunk-QHG4AAOS.js";import{a as X,b as R,c as q,d as K}from"./chunk-ROGIGCUD.js";import{b as j,c as N}from"./chunk-OKGBDOUZ.js";import{i as H,k as z,l as F}from"./chunk-PRT7SSIN.js";import{E as U,F as A,b as B}from"./chunk-3PFQFA46.js";import{Ab as _,Bb as c,Jb as k,Lb as r,Ma as P,Mb as f,Nb as C,Oa as V,Ob as I,Pa as a,Qb as L,Rb as O,Vb as M,Zb as D,_ as w,da as u,db as E,ea as x,ma as v,mb as p,nb as s,ob as T,pb as S,qb as y,rb as g,sb as i,tb as o,ub as b,yb as h}from"./chunk-D6KF5352.js";var J=()=>["/gallery"],Q=e=>({tag:e}),Z=e=>["/photo",e],tt=(e,n)=>n.id;function et(e,n){if(e&1&&b(0,"app-blurhash-placeholder",3),e&2){let t=c();g("hash",t.placeholder)("width",64)("height",64)}}function nt(e,n){if(e&1&&b(0,"source",4),e&2){let t=c();g("srcset",t.variants.large.avifUrl)}}function it(e,n){if(e&1&&b(0,"source",5),e&2){let t=c();g("srcset",t.variants.large.webpUrl)}}function ot(e,n){if(e&1){let t=h();i(0,"button",19),_("click",function(d){u(t);let m=c(2);return x(m.navigatePrev(d))}),i(1,"mat-icon"),r(2,"chevron_left"),o()()}}function at(e,n){if(e&1){let t=h();i(0,"button",20),_("click",function(d){u(t);let m=c(2);return x(m.navigateNext(d))}),i(1,"mat-icon"),r(2,"chevron_right"),o()()}}function rt(e,n){if(e&1&&(i(0,"p",23),r(1),o()),e&2){let t=c(2);a(),f(t.description)}}function lt(e,n){if(e&1&&(i(0,"div",25),r(1,"Date"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2),l=c();a(3),f(l.formatDate(t.takenAt))}}function ct(e,n){if(e&1&&(i(0,"div",25),r(1,"Camera maker"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2);a(3),f(t.exif==null?null:t.exif.cameraMake)}}function dt(e,n){if(e&1&&(i(0,"div",25),r(1,"Camera model"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2);a(3),f(t.exif==null?null:t.exif.cameraModel)}}function pt(e,n){if(e&1&&(i(0,"div",25),r(1,"F-stop"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2);a(3),C("f/",t.exif==null?null:t.exif.fStop)}}function st(e,n){if(e&1&&(i(0,"div",25),r(1,"Exposure time"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2);a(3),f(t.exif==null?null:t.exif.exposureTime)}}function mt(e,n){if(e&1&&(i(0,"div",25),r(1,"ISO speed"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2);a(3),C("ISO-",t.exif==null?null:t.exif.iso)}}function _t(e,n){if(e&1&&(i(0,"div",25),r(1,"Exposure bias"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2);a(3),C("",t.exif==null?null:t.exif.exposureBias," step")}}function ft(e,n){if(e&1&&(i(0,"div",25),r(1,"Focal length"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2);a(3),C("",t.exif==null?null:t.exif.focalLength," mm")}}function ut(e,n){if(e&1&&(i(0,"div",25),r(1,"Max aperture"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2);a(3),f(t.exif==null?null:t.exif.maxAperture)}}function xt(e,n){if(e&1&&(i(0,"div",25),r(1,"Metering mode"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2);a(3),f(t.exif==null?null:t.exif.meteringMode)}}function gt(e,n){if(e&1&&(i(0,"div",25),r(1,"Flash mode"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2);a(3),f(t.exif==null?null:t.exif.flash)}}function ht(e,n){if(e&1&&(i(0,"div",25),r(1,"35mm focal length"),o(),i(2,"div",26),r(3),o()),e&2){let t=c(2);a(3),f(t.exif==null?null:t.exif.focalLength35mm)}}function Ct(e,n){if(e&1&&(i(0,"a",28),r(1),o()),e&2){let t=n.$implicit;g("routerLink",L(3,J))("queryParams",O(4,Q,t)),a(),C(" ",t," ")}}function vt(e,n){if(e&1&&(i(0,"div",27),S(1,Ct,2,6,"a",28,T),o()),e&2){let t=c(3);a(),y(t.publicTags())}}function bt(e,n){if(e&1){let t=h();i(0,"aside",21),_("click",function(d){return u(t),x(d.stopPropagation())}),i(1,"button",22),_("click",function(d){u(t);let m=c(2);return x(m.toggleInfo(d))}),i(2,"mat-icon"),r(3,"close"),o()(),p(4,rt,2,1,"p",23),i(5,"div",24),p(6,lt,4,1),i(7,"div",25),r(8,"Dimensions"),o(),i(9,"div",26),r(10),o(),p(11,ct,4,1),p(12,dt,4,1),p(13,pt,4,1),p(14,st,4,1),p(15,mt,4,1),p(16,_t,4,1),p(17,ft,4,1),p(18,ut,4,1),p(19,xt,4,1),p(20,gt,4,1),p(21,ht,4,1),i(22,"div",25),r(23,"File size"),o(),i(24,"div",26),r(25),o()(),p(26,vt,3,0,"div",27),o()}if(e&2){let t=c(),l=c();a(4),s(t.description?4:-1),a(2),s(t.takenAt?6:-1),a(4),I("",t.width," \xD7 ",t.height),a(),s(t.exif!=null&&t.exif.cameraMake?11:-1),a(),s(t.exif!=null&&t.exif.cameraModel?12:-1),a(),s(t.exif!=null&&t.exif.fStop?13:-1),a(),s(t.exif!=null&&t.exif.exposureTime?14:-1),a(),s(t.exif!=null&&t.exif.iso?15:-1),a(),s((t.exif==null?null:t.exif.exposureBias)!==null&&(t.exif==null?null:t.exif.exposureBias)!==void 0?16:-1),a(),s(t.exif!=null&&t.exif.focalLength?17:-1),a(),s(t.exif!=null&&t.exif.maxAperture?18:-1),a(),s(t.exif!=null&&t.exif.meteringMode?19:-1),a(),s(t.exif!=null&&t.exif.flash?20:-1),a(),s(t.exif!=null&&t.exif.focalLength35mm?21:-1),a(4),f(l.formatBytes(t.variants.large.bytes)),a(),s(l.publicTags().length>0?26:-1)}}function wt(e,n){if(e&1){let t=h();i(0,"a",29),_("click",function(d){return u(t),x(d.stopPropagation())}),b(1,"img",30),o()}if(e&2){let t=n.$implicit,l=c(2);k("active",t.id===l.id()),g("routerLink",O(5,Z,t.id)),a(),g("src",t.variants.thumb.jpgUrl,P)("alt",t.description||"Thumbnail")}}function Pt(e,n){if(e&1){let t=h();i(0,"div",2),p(1,et,1,3,"app-blurhash-placeholder",3),i(2,"picture"),p(3,nt,1,1,"source",4),p(4,it,1,1,"source",5),i(5,"img",6),_("load",function(){u(t);let d=c();return x(d.onImageLoad())}),o()()(),i(6,"header",7)(7,"button",8),_("click",function(d){u(t);let m=c();return x(m.goBack(d))}),i(8,"mat-icon"),r(9,"arrow_back"),o()(),i(10,"div",9)(11,"button",10),_("click",function(d){u(t);let m=c();return x(m.copyShareLink(d))}),i(12,"mat-icon"),r(13),o()(),i(14,"a",11),_("click",function(d){return u(t),x(d.stopPropagation())}),i(15,"mat-icon"),r(16,"download"),o()(),i(17,"button",12),_("click",function(d){u(t);let m=c();return x(m.toggleInfo(d))}),i(18,"mat-icon"),r(19,"info"),o()()()(),p(20,ot,3,0,"button",13),p(21,at,3,0,"button",14),p(22,bt,27,17,"aside",15),i(23,"footer",16)(24,"div",17),S(25,wt,2,7,"a",18,tt),o()()}if(e&2){let t=n,l=c();a(),s(l.imageLoaded()?-1:1),a(),k("loaded",l.imageLoaded()),a(),s(t.variants.large.avifUrl?3:-1),a(),s(t.variants.large.webpUrl?4:-1),a(),g("src",t.variants.large.jpgUrl,P)("alt",t.description||"Safari photo"),a(8),f(l.linkCopied()?"check":"share"),a(),g("href",t.variants.large.jpgUrl,P),a(6),s(l.adjacent().prev?20:-1),a(),s(l.adjacent().next?21:-1),a(),s(l.showInfo()?22:-1),a(3),y(l.photos())}}function kt(e,n){e&1&&(i(0,"div",1)(1,"p"),r(2,"Photo not found"),o(),i(3,"a",31),r(4,"Return to Gallery"),o()())}var Y=class e{router=w(j);location=w(B);photoService=w(K);id=D.required();photo=M(()=>this.photoService.getPhotoById(this.id()));photos=this.photoService.photos;adjacent=M(()=>this.photoService.getAdjacentPhotos(this.id()));publicTags=M(()=>{let n=this.photo();return n?n.tags.filter(t=>!X(t)):[]});imageLoaded=v(!1);chromeHidden=v(!1);showInfo=v(!1);linkCopied=v(!1);formatDate=q;formatBytes=R;touchStartX=0;ngOnInit(){document.body.style.overflow="hidden"}ngOnDestroy(){document.body.style.overflow=""}onImageLoad(){this.imageLoaded.set(!0)}goBack(n){n.stopPropagation(),this.location.back()}toggleChrome(n){n.target.closest("button, a, .info-panel")||this.chromeHidden.update(t=>!t)}toggleInfo(n){n.stopPropagation(),this.showInfo.update(t=>!t)}copyShareLink(n){n.stopPropagation();let t=window.location.href;navigator.clipboard.writeText(t).then(()=>{this.linkCopied.set(!0),setTimeout(()=>this.linkCopied.set(!1),2e3)})}navigatePrev(n){n.stopPropagation();let t=this.adjacent().prev;t&&(this.imageLoaded.set(!1),this.router.navigate(["/photo",t.id]))}navigateNext(n){n.stopPropagation();let t=this.adjacent().next;t&&(this.imageLoaded.set(!1),this.router.navigate(["/photo",t.id]))}onKeydown(n){switch(n.key){case"ArrowLeft":this.navigatePrev(n);break;case"ArrowRight":this.navigateNext(n);break;case"Escape":this.location.back();break;case"i":this.showInfo.update(t=>!t);break}}onTouchStart(n){this.touchStartX=n.touches[0].clientX}onTouchEnd(n){let l=n.changedTouches[0].clientX-this.touchStartX;Math.abs(l)>50&&(l>0?this.navigatePrev(n):this.navigateNext(n))}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=E({type:e,selectors:[["app-photo-viewer"]],hostBindings:function(t,l){t&1&&_("keydown",function(m){return l.onKeydown(m)},V)("touchstart",function(m){return l.onTouchStart(m)})("touchend",function(m){return l.onTouchEnd(m)})},inputs:{id:[1,"id"]},decls:3,vars:3,consts:[[1,"viewer-container",3,"click"],[1,"not-found"],[1,"image-container"],[3,"hash","width","height"],["type","image/avif",3,"srcset"],["type","image/webp",3,"srcset"],["draggable","false",3,"load","src","alt"],[1,"viewer-header"],["mat-icon-button","","aria-label","Go back",3,"click"],[1,"header-actions"],["mat-icon-button","","matTooltip","Copy link","aria-label","Copy share link",3,"click"],["mat-icon-button","","download","","matTooltip","Download high-res","aria-label","Download high-res",3,"click","href"],["mat-icon-button","","matTooltip","Photo info","aria-label","Toggle photo info",3,"click"],["mat-icon-button","","aria-label","Previous photo",1,"nav-button","nav-prev"],["mat-icon-button","","aria-label","Next photo",1,"nav-button","nav-next"],[1,"info-panel"],[1,"filmstrip"],[1,"filmstrip-track"],[1,"filmstrip-item",3,"routerLink","active"],["mat-icon-button","","aria-label","Previous photo",1,"nav-button","nav-prev",3,"click"],["mat-icon-button","","aria-label","Next photo",1,"nav-button","nav-next",3,"click"],[1,"info-panel",3,"click"],["mat-icon-button","","aria-label","Close info panel",1,"close-info",3,"click"],[1,"description"],[1,"info-grid"],[1,"info-label"],[1,"info-value"],[1,"tags"],[1,"tag",3,"routerLink","queryParams"],[1,"filmstrip-item",3,"click","routerLink"],["loading","lazy",3,"src","alt"],["mat-button","","routerLink","/gallery"]],template:function(t,l){if(t&1&&(i(0,"div",0),_("click",function(m){return l.toggleChrome(m)}),p(1,Pt,27,12)(2,kt,5,0,"div",1),o()),t&2){let d;k("chrome-hidden",l.chromeHidden()),a(),s((d=l.photo())?1:2,d)}},dependencies:[N,F,z,H,A,U,W,G,$],styles:[".viewer-container[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0a0a0a;display:flex;align-items:center;justify-content:center;z-index:2000}.image-container[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center}.image-container[_ngcontent-%COMP%]   picture[_ngcontent-%COMP%]{display:contents;opacity:0;transition:opacity .4s ease}.image-container[_ngcontent-%COMP%]   picture.loaded[_ngcontent-%COMP%]{opacity:1}.image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain;-webkit-user-select:none;user-select:none}.viewer-header[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;display:flex;justify-content:space-between;align-items:center;padding:1rem 1.5rem;padding-top:calc(1rem + env(safe-area-inset-top,0));background:linear-gradient(to bottom,rgba(0,0,0,.8),transparent);transition:opacity .3s ease;color:#fff}.viewer-header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .viewer-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#fff!important}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.25rem}.nav-button[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);color:#fff!important;background:#0009!important;width:48px;height:48px;transition:opacity .3s ease,background .2s ease}.nav-button[_ngcontent-%COMP%]:hover{background:#000000d9!important}.nav-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}.nav-prev[_ngcontent-%COMP%]{left:1.5rem}.nav-next[_ngcontent-%COMP%]{right:1.5rem}.info-panel[_ngcontent-%COMP%]{position:absolute;top:80px;right:1.5rem;width:320px;max-width:calc(100vw - 3rem);background:#0f0f0ff2;backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border-radius:var(--radius-lg, 12px);border:1px solid rgba(255,255,255,.1);padding:1.5rem;color:#fff;box-shadow:0 8px 32px #00000080}.close-info[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem;color:#ffffffb3!important}.close-info[_ngcontent-%COMP%]:hover{color:#fff!important}.description[_ngcontent-%COMP%]{margin:0 0 1.25rem;font-size:1rem;line-height:1.7;color:#fffffff2;padding-bottom:1rem;border-bottom:1px solid rgba(255,255,255,.1)}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr;gap:.5rem 1rem;font-size:.85rem;max-height:300px;overflow-y:auto}.info-label[_ngcontent-%COMP%]{color:#ffffff80;white-space:nowrap}.info-value[_ngcontent-%COMP%]{color:#ffffffe6;text-align:right}.tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:1.25rem;padding-top:1.25rem;border-top:1px solid rgba(255,255,255,.1)}.tag[_ngcontent-%COMP%]{background:#c2703e33;border:1px solid rgba(194,112,62,.4);padding:.35rem .85rem;border-radius:999px;font-size:.8rem;font-weight:500;color:#c2703e;text-decoration:none;transition:background .2s ease,border-color .2s ease}.tag[_ngcontent-%COMP%]:hover{background:#c2703e59;border-color:#c2703e99}.filmstrip[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;background:linear-gradient(to top,rgba(0,0,0,.85),transparent);padding:1.25rem 1.5rem;padding-bottom:calc(1.25rem + env(safe-area-inset-bottom,0));transition:opacity .3s ease}.filmstrip-track[_ngcontent-%COMP%]{display:flex;gap:.625rem;overflow-x:auto;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch;padding:.25rem 0}.filmstrip-track[_ngcontent-%COMP%]::-webkit-scrollbar{height:6px}.filmstrip-track[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#ffffff1a;border-radius:3px}.filmstrip-track[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ffffff4d;border-radius:3px}.filmstrip-item[_ngcontent-%COMP%]{flex-shrink:0;width:64px;height:64px;border-radius:6px;overflow:hidden;scroll-snap-align:center;opacity:.5;transition:opacity .2s ease,transform .2s ease;border:2px solid transparent}.filmstrip-item.active[_ngcontent-%COMP%]{opacity:1;border-color:#c2703e;box-shadow:0 0 12px #c2703e66}.filmstrip-item[_ngcontent-%COMP%]:hover{opacity:.85}.filmstrip-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.chrome-hidden[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%], .chrome-hidden[_ngcontent-%COMP%]   .nav-button[_ngcontent-%COMP%], .chrome-hidden[_ngcontent-%COMP%]   .filmstrip[_ngcontent-%COMP%]{opacity:0;pointer-events:none}.not-found[_ngcontent-%COMP%]{text-align:center;color:#fff;padding:2rem}.not-found[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.25rem;margin-bottom:1.5rem;color:#fffc}.not-found[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#c2703e!important;border-color:#c2703e!important}@media (max-width: 768px){.nav-button[_ngcontent-%COMP%]{display:none}.info-panel[_ngcontent-%COMP%]{top:auto;bottom:110px;left:1rem;right:1rem;width:auto;max-height:50vh;overflow-y:auto}.filmstrip-item[_ngcontent-%COMP%]{width:56px;height:56px}}@media (prefers-reduced-motion: reduce){.viewer-header[_ngcontent-%COMP%], .nav-button[_ngcontent-%COMP%], .filmstrip[_ngcontent-%COMP%], .image-container[_ngcontent-%COMP%]   picture[_ngcontent-%COMP%], .filmstrip-item[_ngcontent-%COMP%], .tag[_ngcontent-%COMP%]{transition:none}}"]})};export{Y as PhotoViewerComponent};
